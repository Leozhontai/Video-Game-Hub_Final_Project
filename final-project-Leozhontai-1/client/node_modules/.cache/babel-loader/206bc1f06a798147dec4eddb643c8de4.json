{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/leozh/OneDrive/Desktop/GitHub/Hw/Public_Final/Video-Game-Hub_Final_Project/final-project-Leozhontai-1/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/leozh/OneDrive/Desktop/GitHub/Hw/Public_Final/Video-Game-Hub_Final_Project/final-project-Leozhontai-1/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/leozh/OneDrive/Desktop/GitHub/Hw/Public_Final/Video-Game-Hub_Final_Project/final-project-Leozhontai-1/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/leozh/OneDrive/Desktop/GitHub/Hw/Public_Final/Video-Game-Hub_Final_Project/final-project-Leozhontai-1/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/leozh/OneDrive/Desktop/GitHub/Hw/Public_Final/Video-Game-Hub_Final_Project/final-project-Leozhontai-1/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import'./CreatePost.css';import{supabase}from'../client.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreatePost=function CreatePost(){var _useState=useState({title:\"\",content:\"\",image_url:\"\"}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];console.log('post: ',post);var handleChange=function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;console.log(\"Name: \",name,\" value: \",value);setPost(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},name,value));});};var handleFileChange=function handleFileChange(e){setFile(e.target.files[0]);};var createPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var imageUrl,_yield$supabase$stora,uploadError,uploadData,_yield$supabase$from$,data,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();imageUrl=post.image_url;if(!file){_context.next=12;break;}_context.next=5;return supabase.storage.from('post-images').upload(file.name,file);case 5:_yield$supabase$stora=_context.sent;uploadError=_yield$supabase$stora.error;uploadData=_yield$supabase$stora.data;if(!uploadError){_context.next=11;break;}console.error(uploadError);return _context.abrupt(\"return\");case 11:// Update the image_url field with the URL of the uploaded file\nimageUrl=supabase.storage.from('post-images').getPublicUrl(uploadData.Key);case 12:_context.next=14;return supabase.from(\"hub\").insert({title:post.title,content:post.content,image_url:imageUrl}).select();case 14:_yield$supabase$from$=_context.sent;data=_yield$supabase$from$.data;error=_yield$supabase$from$.error;console.log(data);console.log(error);window.location=\"/\";case 20:case\"end\":return _context.stop();}}},_callee);}));return function createPost(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",id:\"title\",name:\"title\",onChange:handleChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Content\",id:\"content\",name:\"content\",onChange:handleChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Image URL\",id:\"image_url\",name:\"image_url\",onChange:handleChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Create Post\",onClick:createPost})]})});};export default CreatePost;","map":{"version":3,"names":["React","useState","supabase","CreatePost","title","content","image_url","post","setPost","file","setFile","console","log","handleChange","event","target","name","value","prev","handleFileChange","e","files","createPost","preventDefault","imageUrl","storage","from","upload","uploadError","error","uploadData","data","getPublicUrl","Key","insert","select","window","location"],"sources":["C:/Users/leozh/OneDrive/Desktop/GitHub/Hw/Public_Final/Video-Game-Hub_Final_Project/final-project-Leozhontai-1/client/src/pages/CreatePost.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './CreatePost.css';\nimport { supabase } from '../client.js';\n\nconst CreatePost = () => {\n  const [post, setPost] = useState({ title: \"\", content: \"\", image_url: \"\"});\n  const [file, setFile] = useState(null);\n  console.log('post: ', post);\n\n  const handleChange = (event) => {\n    const {name, value} = event.target;\n    console.log(\"Name: \", name, \" value: \", value);\n    setPost( (prev) => {\n      return {\n        ...prev,\n        [name]:value,\n      }\n    })\n  }\n\n  const handleFileChange = e => {\n    setFile(e.target.files[0]);\n  };\n\n  const createPost = async (event) => {\n    event.preventDefault();\n\n    let imageUrl = post.image_url;\n\n    if (file) {\n      // Upload the file to Supabase Storage\n      const { error: uploadError, data: uploadData } = await supabase.storage.from('post-images').upload(file.name, file);\n\n      if (uploadError) {\n        console.error(uploadError);\n        return;\n      }\n\n      // Update the image_url field with the URL of the uploaded file\n      imageUrl = supabase.storage.from('post-images').getPublicUrl(uploadData.Key);\n    }\n\n    const { data, error } = await \n    supabase.from(\"hub\").insert({\n      title: post.title,\n      content: post.content,\n      image_url: imageUrl,\n    })\n    .select();\n    console.log(data);\n    console.log(error);\n    window.location = \"/\";\n  };\n\n  return (\n    <div>\n      <form>\n        <input type=\"text\" placeholder=\"Title\" id=\"title\" name=\"title\" onChange={handleChange} /><br />\n        <br/>\n\n        <input type=\"text\" placeholder=\"Content\" id=\"content\" name=\"content\" onChange={handleChange}/><br />\n        <br/>\n\n        <input type=\"text\" placeholder=\"Image URL\" id=\"image_url\" name=\"image_url\" onChange={handleChange}/><br />\n        <br/>\n\n        <input type=\"file\" accept=\"image/*\" onChange={handleFileChange} /><br />\n        <br/>\n\n        <input type=\"submit\" value=\"Create Post\" onClick={createPost}/>\n      </form>\n    </div>\n  )\n}\n\nexport default CreatePost;"],"mappings":"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"},"metadata":{},"sourceType":"module"}